"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}define(["SwiftOtter_Test/js/renderer/slide/question.babel","SwiftOtter_Test/js/api.babel","SwiftOtter_Test/js/ga.babel"],function(r,n,l){function c(e){return e.results.score>this.config.pass_score?"test-stats--passed":"test-stats--failed"}return function(){function s(e,t){_classCallCheck(this,s),this.container=e,this.config=t,this.slideRenderer=new r(this.config),this.api=new n({urls:{}})}return _createClass(s,[{key:"render",value:function(e,t){this.container.innerHTML="",this.container.appendChild(this.renderHtml(t)),this.bindEmail(e,t),t.hasOwnProperty("all_features_available")&&t.all_features_available?(l.completeTest(),this.allFeaturesAvailable=!0):(l.completeFreeTest(),this.allFeaturesAvailable=!1),t.results.hasOwnProperty("predicted_pass_percentage")&&t.results.hasOwnProperty("pass_percentage")&&this.allFeaturesAvailable||(this.container.querySelector(".test-stats__prediction").style.display="none")}},{key:"bindEmail",value:function(t,s){var n=this,e=this.container.querySelector(".email-me");s.client_id;e&&s.hasOwnProperty("all_features_available")&&s.all_features_available?e.style.display="":(this.container.querySelector(".email-me-message").style.display="none",this.container.querySelector(".email-me__title").style.display="none"),this.container.querySelector(".email-me__submit").addEventListener("click",function(e){(function(e,t){var s=this,n=this.container.querySelector(".email-me__email"),a=this.container.querySelector(".email-me__name"),i=this.container.querySelector(".email-me");i.classList.add("is-loading"),l.sendEmail(),this.api.email(e,t,n.value,a.value).then(function(){i.classList.remove("is-loading");var e=s.container.querySelector(".email-me-message");e.innerText="Your scores have been sent!",setTimeout(function(){return e.innerText=""},4e3)})}).call(n,t,s.client_id)})}},{key:"renderHtml",value:function(e){var t=this,s=e.questions.filter(function(e){return 0<e.id}),n=1,a=s.map(function(e){return new r(t.config,e).render(n++,s.count,{questionModifier:"test-question--answered",answerModifier:"test-question__answer--answered",disableFormFields:!0}).firstElementChild.outerHTML}),i='\n        <div class="test-stats-container">\n        <div class="test-primary-results">\n          <h2>Result card</h2>\n          <h3>'.concat(e.name,'</h3>\n          <ul class="test-stats ').concat(c.call(this,e),'">\n              <li class="test-stats__score test-stats__item">\n                <span class="score">').concat(e.results.score,'%</span><br/>\n                <span class="text">your score</span>\n              </li>\n              <li class="test-stats__prediction test-stats__item">\n                  <span class="score">').concat(e.results.pass_text,'</span><br/>\n                  <span class="text">').concat(e.results.pass_percentage,'% of passing (in beta, but <a href="https://swiftotter.com/test-score-prediction-information" target="_blank">proving accurate</a>).</span>\n              </li>\n          </ul>\n          <p class="test-stats__guidance">').concat(e.results.guidance,'</p>\n          <h4 class="email-me__title">Email results to me:</h4>\n          <div class="email-me" style="display: none">\n              <input type="email" placeholder="Your email" class="email-me__email input-text" value="').concat(localStorage.hasOwnProperty("email")?localStorage.email:"",'"/>\n              <input type="text" placeholder="Your name" class="email-me__name input-text" value="').concat(localStorage.hasOwnProperty("name")?localStorage.name:"",'"/>\n              <button type="button" class="email-me__submit info-button">Send. ').concat(window.jsonConfig.icons.next,'</button>\n          </div>\n          <div class="email-me-message"></div>\n          ').concat(this.renderObjectiveScores(e),'\n        </div>\n        <ul class="test-questions test-questions--answered">').concat(a.join("\n"),'</ul>\n        <div class="test-status__button-container">\n            <button class="test-question__close info-button">Close</button>\n            <button class="test-question__restart info-button">Start Over</button>\n        </div>        \n        </div>\n      ');return document.createRange().createContextualFragment(i)}},{key:"renderObjectiveScores",value:function(e){if(!e.results.hasOwnProperty("objective_results")||!e.results.objective_results.length)return"";if(e.hasOwnProperty("all_features_available")&&e.all_features_available){var t=e.results.objective_results.map(function(e){return e=JSON.parse(e),'\n          <li>\n            <span class="objective__score">'.concat(e.score,'% correct</span>\n            <span class="objective__title">').concat(e.name,"</span>\n          </li>\n        ")});return'\n        <ul class="objective-stats '.concat(c.call(this,e),'">\n            ').concat(t.join("\n"),"\n        </ul>")}}},{key:"renderQuestion",value:function(t){var s=this;return'\n        <li class="test-question test-question__answered" data-question-id="'.concat(t.id,'">\n            <h2 class="test-question__title">').concat(t.question,'</h2>\n            <div class="test-question__subtext">').concat(t.subtext,'</div>\n            <ul class="test-question__answers">\n                ').concat(t.answers.map(function(e){return s.renderAnswer(t,e,"test-question__answered")}).join("\n"),"\n            </ul>\n        </li>\n      ")}},{key:"renderAnswer",value:function(e,t){var s=t.is_chosen?' checked="checked"':"",n=t.is_chosen?" test-question__answer--chosen":"",a=t.is_correct?" test-question__answer--correct":"";return"onechoice"===e.type?'<li class="test-question__answer test-question__answer--onechoice'.concat(a).concat(n,'" data-question-id="').concat(e.id,'"><label><input type="radio" name="question-').concat(e.id,'"').concat(s," disabled/>").concat(t.answer,"</label></li>"):'<li class="test-question__answer test-question__answer--multichoice'.concat(a).concat(n,'" data-question-id="').concat(e.id,'"><label><input type="checkbox" name="question-').concat(e.id,'"').concat(s," disabled/>").concat(t.answer,"</label></li>")}}]),s}()});
//# sourceMappingURL=results.babel.min.js.map
